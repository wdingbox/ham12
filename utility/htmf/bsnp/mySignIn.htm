<html>

<head>
    <title>signin</title>
    <base target="xxx_blank" />
    <META http-equiv="Content-Type" content="text/html;" charset="UTF-8">
    <META name="viewport" content="width=device-witdh, initial-scale=1, maximum-scale=1, user-scale=0">


    <link rel="stylesheet" xxhref="./BibleStudyNotePad.css?v=2020dec21b">
    </link>

    <!-------------------------------------------->
    <!---- Insert this before scripts import; then restor back later -->
    <script>//if (typeof module === 'object') { window.module = module; module = undefined; }</script>

    <!-------------- jq --------------------->
    <script ____src="./doc_files/jquery-2_1_3.min.js"></script>
    <script src="https://wdingbox.github.io/ham12/jq/jquery-2_1_3.min.js"></script>
    <script language="javascript" src="./BibleStudyNotePad.js?v=20.12.4"></script>
    <!-------------------------------------------->

    <!-------------------------------------------->
    <style>
        body {
            background-color: aliceblue;
            margin: 0px 0px 0px 0px;
            padding: 0px 0px 0px 0px;
            width: 100%;
        }

        form {
            background-color: rgb(204, 177, 161);


            margin: 0px 10px 0px 10px;
            padding: 1px 10px 0px 10px;
        }

        .centered_elem {
            display: block;
            margin-left: auto;
            margin-right: auto;
            background-color: rgb(204, 177, 161);

            text-align: center;
            margin: 0px 10px 0px 10px;
            padding: 0px 10px 10px 10px;
        }


        table {
            padding: 10px 10px 10px 10px;
            margin: 10px 10px 10px 10px;
            /*font-size:xx-large;*/
        }

        .white_space_nowrap {
            white-space: nowrap;
        }

        textarea,
        .txarea {
            width: 100%;
        }

        .hili {
            background-color: red;
        }

        .help_label {
            float: right;
        }

        .helpinfo {
            display: none;
            margin-left: 1px;
        }
    </style>
</head>

<body>
    <p style="text-align: center;margin-top: 50px;">Welcome to</p>
    <h2 style="text-align: center;margin-top: 50px;">Bible Study Note Pad</h2>





    <form action="">
        <h3 style="text-align: center;margin-top: 50px;">Sign In Page</h3>
        <div>
            <a id="">Repository:</a> (<font color='red'>required</font>)
            [ <a class="" id="Format_Check">Format Check</a> ]
            <a class="help_label" onclick="$('.helpinfo.Repository').toggle('slow');">help?</a>
        </div>
        <div class="helpinfo Repository" id="help_Repository">

            <ol>
                <a>To get your repository https url:</a>
                <li>
                    sign in/up your account at <a href="https://github.com/">github.com</a>. (see <a
                        href="https://www.youtube.com/embed/hMfi_ONvGEs?start=40&end=56&autoplay=1">how @0:40</a>)
                </li>
                <li>
                    create a 'New repository' (see <a
                        href="https://www.youtube.com/embed/hMfi_ONvGEs?start=103&end=180&autoplay=1">how
                        @1:40</a>, 'public' is recommended for beginner.)
                </li>
                <li>
                    click green button ["Clone or download"], then click <svg version="1.1" width="16" height="16"
                        viewBox="0 0 16 16" class="octicon octicon-clippy" aria-label="The clipboard icon" role="img">
                        <path fill-rule="evenodd"
                            d="M5.75 1a.75.75 0 00-.75.75v3c0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75v-3a.75.75 0 00-.75-.75h-4.5zm.75 3V2.5h3V4h-3zm-2.874-.467a.75.75 0 00-.752-1.298A1.75 1.75 0 002 3.75v9.5c0 .966.784 1.75 1.75 1.75h8.5A1.75 1.75 0 0014 13.25v-9.5a1.75 1.75 0 00-.874-1.515.75.75 0 10-.752 1.298.25.25 0 01.126.217v9.5a.25.25 0 01-.25.25h-8.5a.25.25 0 01-.25-.25v-9.5a.25.25 0 01.126-.217z">
                        </path>
                    </svg> (copy https url). (see <a
                        href="https://www.youtube.com/embed/X5e3xQBeqf8?start=120&end=134&autoplay=1">how @2:05</a>) Now
                    paste it in our page.
                </li>
            </ol>

            <table border='1'>
                <caption>Formats of Repository String</caption>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Format</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>full https url</td>
                        <td>https://github.com/usrname/repositoryname.git</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>compound IDs</td>
                        <td>usrname/repositoryname</td>
                    </tr>
                </tbody>

            </table>

        </div>
        <div>
            <textarea id="repopath" value="https://github.com/bsnp21/pub_test.git"
                placeholder="https://github.com/username/reposname.git">https://github.com/bsnp21/pub_test.git</textarea>
        </div>


        <br>
        <div>
            Description: (optional)
        </div>
        <div>
            <textarea id="repodesc" value="" placeholder="date, place, event, group, etc"></textarea>
        </div>




        <br>

        <div for="editor1" id="label_password">
            Password: (<font color='red'>required</font>) <a class="help_label"
                onclick="$('.helpinfo.Password').toggle('slow');"></a>
        </div>
        <div class="helpinfo Password">
            <a>
                The passwod is required for
            </a>
            <ol>
                <li>
                    push data into repository (public or private), or
                </li>
                <li>
                    pull data from private repository.
                </li>
            </ol>
            <a>
                For security, the password can be used right before you manually push data into the repository before
                you left.
            </a>
        </div>
        <input id="passcode" type="password" value=""></input>
        <br>
        <hr />
        <br>
    </form>
    <div class="centered_elem">
        <button onclick="repo_create();">Sing In</button>
    </div>
    <p class=".centered_elem">
        <a onclick="repo_destroy();"></a>
        <a onclick="repo_pushback();"></a>
        <a onclick="repo_status();"></a>
        <a onclick="Okey_use_this();"></a>
    </p>
    <p>
        <a onclick="LoadStorageInRepos();"></a>
        <a onclick="LoadStorage();"></a>
    </p>
    <p>
        <a id="histroy" onclick="repo_histroy();"></a>
        <a onclick="RemoveInHistory();"></a>
    </p>



    <div id="footer" style="text-align: center;margin-top: 50px;">
        <div id="otb"></div>
        <hr id="toggle_txtarea">
        <textarea id="txtarea" rows="25"></textarea>
    </div>





    <script>

        function Okey_use_this() {
            if (!Jsonpster.inp) return alert("empty inp")
            if (!Jsonpster.inp.usr) return alert("empty usr")
            Jsonpster.inp.usr = MyStorage.Repositories().repos_app_update()
            


        }
        function repo_create() {
            $("#otb").html("<font color='black'>Start to sign in ... </font>")

            var repopath = $("#repopath").val()
            var reo = Uti.validate_repository_url(repopath)
            if (!reo) {
                $("#otb").html("<font color='red'>Error format: Repository</font>")
                return;
            }

            Jsonpster.inp.usr = MyStorage.Repositories().repos_app_update()
            
            Jsonpster.api = RestApi.ApiUsrReposData_create.str
            dbg_pster()
            Jsonpster.Run(function (ret) {
                dbg_pster(ret)
                if (ret.out.state) {
                    if (1 === ret.out.state.bRepositable) {
                        window.open("BibleStudyNotePad.htm?ip=" + g_ip, '_self');
                    } else {
                        $("#otb").html("<font color='red'>Error: Wrong Repository or Password</font>")
                    }
                } else {
                    $("#otb").html("<font color='red'>Error: Wrong Repository</font>")
                }
            })
        }
        function repo_destroy() {
            if (!confirm("The Bible Study Note you wrote will be destroyed permanently.")) return
            Jsonpster.inp.usr = MyStorage.Repositories().repos_app_update()
            
            Jsonpster.api = RestApi.ApiUsrReposData_destroy.str
            dbg_pster()
            Jsonpster.Run(function (ret) {

                dbg_pster(ret)
            })
        }
        function repo_status() {
            Jsonpster.inp.usr = MyStorage.Repositories().repos_app_update()
            
            Jsonpster.api = RestApi.ApiUsrReposData_status.str
            dbg_pster()
            Jsonpster.Run(function (ret) {

                dbg_pster(ret)
                Uti.Msg("Status inp.ret.out=", ret.out)
            })
        }


        function RemoveInHistory() {
            var rep = $(".hili").find("td:eq(1)").text()
            var pws = $(".hili").find("td:eq(2)").text()

            var ret = confirm("remove in history?\n" + rep + "\n" + pws, "reposit")
            if (ret) {
                MyStorage.Repositories().repos_store_del({ repopath: rep, passcode: pws })
                $(".hili").remove()
            }
        }
    </script>
</body>

</html>
<script>
    $(function () {
        $("#txtarea").hide()
        $("#toggle_txtarea").on("click", function () {
            $("#txtarea").toggle()
        })

        $("#label_password").on("click", function () {
            var typns = $("#passcode").attr("type")
            typns = ("password" === typns) ? "text" : "password"
            $("#passcode").attr("type", typns)
        })

        Uti.visual_check_repository("#Format_Check")
        // $("#Format_Check").on("click", function () {
        //     var repopath = $("#repopath").val()
        //     var reob = Uti.validate_repository_url(repopath)
        //     if (!reob) return alert("empty")
        //     if (reob.format === 2) {
        //         $("#repopath").val(reob.user_repo)
        //     }
        //     if (reob.format === 1) {
        //         $("#repopath").val(reob.full_path)
        //     }
        //     var ar = ["", "https url", "user repos"]
        //     $(this).text(ar[reob.format])
        // })

    })
</script>
<script>
    var g_ip = Uti.Jsonpster_crossloader()

    function dbg_pster(dat) {
        var ss = dat
        if ("object" === typeof dat) {
            var ss = "ret=" + JSON.stringify(dat, null, 4)
        }
        ss += "\n\n\nJsonpster = " + JSON.stringify(Jsonpster, null, 4)
        ss += "\n\n\nRestApi=" + JSON.stringify(RestApi, null, 4)
        $("#txtarea").val(ss)
    }
    setTimeout(() => {
        if (undefined === Jsonpster) {
            alert("Jsonpster not exist.")
        }
        else {
            $("title").text("signin")
            dbg_pster()
            var ar = MyStorage.Repositories().repos_app_init()

            //$("#histroy").trigger("click")
        }
        //g_msg.pop(`initial load file: ${ret.name}, size:${data.length}(B)`).m_len = data.length
    }, 2000)
</script>