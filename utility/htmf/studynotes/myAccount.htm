<html>

<head>
    <base target="_blank" />
    <META http-equiv="Content-Type" content="text/html;" charset="UTF-8">
    <METAxxxx name="viewport" content="width=device-witdh, initial-scale=1, maximum-scale=1, user-scale=0">


        <link rel="stylesheet" hrefxxxxxxxxx="./BibleStudyNotePad.css?v=2020dec21b">
        </link>

        <!-------------------------------------------->
        <!---- Insert this before scripts import; then restor back later -->
        <script>//if (typeof module === 'object') { window.module = module; module = undefined; }</script>

        <!-------------- jq --------------------->
        <script ____src="./doc_files/jquery-2_1_3.min.js"></script>
        <script src="https://wdingbox.github.io/ham12/jq/jquery-2_1_3.min.js"></script>
        <script xxxxxxxsrc="http://localhost:7878/assets/ckeditor/adapters/jq/jquery-2_1_3.min.js"
            note="selfseversite"></script>
        <!-------------- ckeditor only--------------------->
        <script src="../../../assets/ckeditor/ckeditor.js"></script>
        <script src="../../../assets/ckeditor/samples/old/sample.js"></script>
        <link href="../../../assets/ckeditor/samples/old/sample.css" rel="stylesheet">


        <script ___src="http://localhost:7878/assets/ckeditor/ckeditor.js" note="selfseversite"></script>
        <script ___src="http://localhost:7878/assets/ckeditor/samples/old/sample.js"></script>
        <!-------------------------------------------->
        <!----- Insert this line after script imports -->
        <script>//if (window.module) module = window.module;</script>
        <script language="javascript" src="./BibleStudyNotePad.js?v=20.12.4"></script>
        <!-------------------------------------------->
        <style>
            body {
                padding: 10px 10px 10px 10px;
                margin: 10px 10px 10px 10px;
                font:32px;
            }


            .white_space_nowrap {
                white-space: nowrap;
            }

            textarea {
                width: 100px;
            }

            .hili {
                background-color: red;
            }

            #help {
                float: right;
            }

            #helpInfo {
                display: none;
            }
        </style>
</head>

<body>



    <form action="" method="post">
        <div>
            Repository <a id="help" onclick="$('#helpInfo').toggle('slow');">help?</a>
        </div>
        <div id="helpInfo">
            <p>
                To get a repository:
            </p>
            <ol>
                <li>
                    register account in <a href="https://github.com/">github.com</a>
                </li>
                <li>
                    create a New repository to get copy of HTTPS url)
                </li>
            </ol>
        </div>
        <textarea id="repository" value="https://github.com/wdingbox/bible_user_williamd.git"></textarea>
        <label for="editor1">
            Password
        </label>
        <input id="passcode" value=""></input>
    </form>
    <p>
        <button onclick="repo_create();">create</button>
        <button onclick="repo_destroy();">destroy</button>
        <button onclick="repo_histroy();">histroy</button>
        <button onclick="RemoveInHistory();">RemoveInHistory</button>


    </p>



    <div id="footer">
        <hr>
        <textarea id="txtarea" rows="25"></textarea>
    </div>





    <script>
        function repo_create() {
            var pname = $("#repository").val()
            var pcode = $("#passcode").val()
            MyStorage.Repositories().add({ repository: pname, passcode: pcode })

            Jsonpster.inp.usr.repository = pname;
            Jsonpster.inp.usr.passcode = pcode;
            Jsonpster.api = RestApi.ApiUsrReposData_create.str
            dbg_pster()
            Jsonpster.Run(function (ret) {
                window.opener.postMessage(Jsonpster.inp.usr, '*');
                dbg_pster(ret)
            })
        }
        function repo_destroy() {
            var pname = $("#repository").val()
            var pcode = $("#passcode").val()
            Jsonpster.inp.usr.repository = pname;
            Jsonpster.inp.usr.passcode = pcode;
            Jsonpster.api = RestApi.ApiUsrReposData_destroy.str
            dbg_pster()
            Jsonpster.Run(function (ret) {
                window.opener.postMessage(Jsonpster.inp.usr, '*');
                dbg_pster(ret)
            })
        }
        function repo_histroy() {
            var ar = MyStorage.Repositories().get()
            var stb = "<table id='account_history_table' border='1'><caption>History</caption>"
            for (var i = 0; i < ar.length; i++) {
                stb += `<tr><td>${i}</td>`
                Object.keys(ar[i]).forEach(function (key) {
                    stb += `<td>${ar[i][key]}</td>`
                })
                stb += "</tr>"
            }
            stb += "</table>"
            $("#footer").find("#account_history_table").remove()
            $("#footer").prepend(stb).find("tr").bind("click", function () {
                var rep = $(this).find("td:eq(1)").text()
                var pws = $(this).find("td:eq(2)").text()
                var pname = $("#repository").val(rep)
                var pcode = $("#passcode").val(pws)
                $("tr.hili").removeClass("hili")
                $(this).addClass("hili")

            })
        }
        function RemoveInHistory() {
            var rep = $(".hili").find("td:eq(1)").text()
            var pws = $(".hili").find("td:eq(2)").text()

            var ret = confirm("remove in history?\n" + rep + "\n" + pws, "reposit")
            if (ret) {
                MyStorage.Repositories().del({ repository: rep, passcode: pws })
                $(".hili").remove()
            }
        }
    </script>
</body>

</html>
<script>
    Uti.Jsonpster_crossloader()
    function dbg_pster(dat) {
        var ss = dat
        if ("object" === typeof dat) {
            var ss = "ret=" + JSON.stringify(dat, null, 4)
        }
        ss += "\n\n\nJsonpster = " + JSON.stringify(Jsonpster, null, 4)
        ss += "\n\n\nRestApi=" + JSON.stringify(RestApi, null, 4)
        $("#txtarea").val(ss)
    }
    setTimeout(() => {
        if (undefined === Jsonpster) {
            alert("Jsonpster not exist.")
        }
        else {
            $("title").text("acct")
            dbg_pster()
        }
        //g_msg.pop(`initial load file: ${ret.name}, size:${data.length}(B)`).m_len = data.length
    }, 1000)
</script>
<script>
    $(function () {
        //init_CKEditor()
        //init_ui_cmd()
        //load_page_by_parent_storage()


    })
</script>